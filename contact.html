<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Encryptify | Contacto</title>
    <link rel="stylesheet" href="assets/css/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- EmailJS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script>
      (function () {
        emailjs.init("P-MYFtgGFfMP9k_Us"); // Reemplaza con tu User ID de EmailJS
      })();
    </script>
    <style>
      .required {
        color: red;
        font-weight: bold;
        margin-left: 4px;
      }
      #status {
        margin-top: 10px;
        font-weight: bold;
      }
      #status.error {
        color: red;
      }
      #status.success {
        color: green;
      }
      .note {
        font-size: 0.9em;
        color: #555;
        margin-top: 8px;
      }
    </style>
  </head>
  <body>
    <header>
      <div class="menu">
        <a href="index.html" class="brand">
          <img src="assets/img/logo.png" alt="Logo Encryptify" class="logo" />
        </a>

        <h1 class="site-title">Encryptify</h1>

        <button
          id="nav-toggle"
          class="nav-toggle"
          aria-controls="primary-nav"
          aria-expanded="false"
          aria-label="Abrir men√∫"
        >
          <svg
            class="icon-hamburger"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            aria-hidden="true"
            focusable="false"
          >
            <rect y="5" width="24" height="2" rx="1" fill="#fff" />
            <rect y="11" width="24" height="2" rx="1" fill="#fff" />
            <rect y="17" width="24" height="2" rx="1" fill="#fff" />
          </svg>
        </button>

        <nav
          id="primary-nav"
          class="menu-links"
          role="navigation"
          aria-label="Men√∫ principal"
        >
          <a href="overview.html" class="menu-btn"
            ><i class="fa-solid fa-chart-pie"></i> Visi√≥n General</a
          >
          <a href="pricing-planes.html" class="menu-btn"
            ><i class="fa-solid fa-tags"></i> Planes</a
          >
          <a href="downloads.html" class="menu-btn"
            ><i class="fa-solid fa-download"></i> Descargar</a
          >
          <a href="developer.html" class="menu-btn"
            ><i class="fa-solid fa-user-gear"></i> Desarrollador</a
          >
          <a href="contact.html" class="menu-btn active"
            ><i class="fa-solid fa-envelope"></i> Contacto</a
          >
        </nav>
      </div>
    </header>

    <main>
      <section class="intro">
        <h2><i class="fa-solid fa-envelope"></i> Contacto</h2>
        <p>
          Rellena el siguiente formulario para ponerte en contacto con nosotros.
          Selecciona el plan que te interesa y te responderemos lo antes
          posible.
        </p>
      </section>

      <section class="contact-form">
        <form id="contact-form">
          <div class="form-group">
            <label for="name"
              >Nombre completo <span class="required">*</span></label
            >
            <input type="text" id="name" name="name" required />
          </div>

          <div class="form-group">
            <label for="email"
              >Correo electr√≥nico <span class="required">*</span></label
            >
            <input type="email" id="email" name="email" required />
          </div>

          <div class="form-group">
            <label for="plan"
              >Plan de inter√©s <span class="required">*</span></label
            >
            <select id="plan" name="plan" required>
              <option value="">-- Selecciona un plan --</option>
              <option value="gratuito">Gratuito</option>
              <option value="educativo">Educativo</option>
              <option value="freelance">Freelance</option>
              <option value="legal">Legal</option>
              <option value="forense">Forense</option>
            </select>
          </div>

          <div class="form-group">
            <label for="message">Mensaje <span class="required">*</span></label>
            <textarea id="message" name="message" rows="5" required></textarea>
          </div>

          <button type="submit" class="btn-download">
            <i class="fa-solid fa-paper-plane"></i> Enviar mensaje
          </button>
          <p class="note">
            Los campos marcados con <span class="required">*</span> son
            obligatorios.
          </p>
        </form>
        <p id="status"></p>
      </section>
    </main>

    <footer>
      <p>&copy; 2025 Encryptify. Desarrollado por Iv√°n V√°zquez Vidador.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("contact-form");
        const status = document.getElementById("status");

        if (!form || !status) {
          console.error("‚ùå Elementos #contact-form o #status no encontrados.");
          return;
        }

        // Inicializar EmailJS si no se ha hecho
        if (!emailjs._init) {
          console.log("üîß Inicializando EmailJS...");
          emailjs.init("YOUR_PUBLIC_KEY"); // Reemplaza con tu clave p√∫blica
        }

        form.addEventListener("submit", function (e) {
          e.preventDefault();

          const name = document.getElementById("name")?.value.trim();
          const email = document.getElementById("email")?.value.trim();
          const plan = document.getElementById("plan")?.value.trim();
          const message = document.getElementById("message")?.value.trim();

          console.clear();
          console.log("üì© Enviando formulario...");
          console.log("Datos:", { name, email, plan, message });

          // Validaci√≥n b√°sica
          if (!name || !email || !plan || !message) {
            status.className = "error";
            status.innerHTML = "‚ö†Ô∏è Completa todos los campos obligatorios.";
            console.warn("‚ùå Validaci√≥n fallida: campos vac√≠os");
            return;
          }

          // Validaci√≥n de email
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailRegex.test(email)) {
            status.className = "error";
            status.innerHTML = "‚ö†Ô∏è El correo electr√≥nico no es v√°lido.";
            console.warn("‚ùå Email inv√°lido");
            return;
          }

          // Verificaci√≥n de EmailJS
          if (!emailjs || typeof emailjs.send !== "function") {
            status.className = "error";
            status.innerHTML = "‚ùå Error interno: EmailJS no disponible.";
            console.error("‚ùå EmailJS no est√° cargado correctamente.");
            return;
          }

          // Env√≠o del mensaje
          status.className = "pending";
          status.innerHTML = "‚è≥ Enviando mensaje...";

          emailjs
            .send("service_n73sae3", "template_0xkivdo", {
              name,
              email,
              plan,
              message,
            })
            .then(
              function (response) {
                console.log("‚úÖ EmailJS respuesta:", response);
                status.className = "success";
                status.innerHTML = "‚úÖ Mensaje enviado correctamente.";
                form.reset();
              },
              function (error) {
                console.error("‚ùå Error al enviar:", error);
                status.className = "error";
                status.innerHTML =
                  "‚ùå Error al enviar el mensaje. Intenta m√°s tarde.";
              }
            );
        });
      });
    </script>
  </body>
</html>
